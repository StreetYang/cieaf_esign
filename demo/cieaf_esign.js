var cieaf_esign=(()=>{var b=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames,E=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var T=(t,e,n)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,y=(t,e)=>{for(var n in e||(e={}))w.call(e,n)&&T(t,n,e[n]);if(E)for(var n of E(e))Y.call(e,n)&&T(t,n,e[n]);return t};var H=(t,e)=>{for(var n in e)b(t,n,{get:e[n],enumerable:!0})},X=(t,e,n,c)=>{if(e&&typeof e=="object"||typeof e=="function")for(let d of C(e))!w.call(t,d)&&d!==n&&b(t,d,{get:()=>e[d],enumerable:!(c=B(e,d))||c.enumerable});return t};var I=t=>X(b({},"__esModule",{value:!0}),t);var R={};H(R,{create:()=>W});function r(t,e,n){let c=document.createElement(t);return e&&Object.assign(c,e),n&&n.appendChild(c),c}function W(t){t=y({color:"black",background:"white",lineWidth:2,title:"",parent:document.body,ok(o){console.log(o)}},t);let e=r("div",{className:"cieaf-esign"},t.parent);t.parent.tagName==="BODY"?Object.assign(e.style,{position:"fixed",top:0,left:0,zIndex:1e4,width:"100vw",height:"100vh"}):Object.assign(e.style,{position:"relative",width:"100%",height:"100%"});let n=e.offsetWidth,c=e.offsetHeight,d=r("header",{className:"cieaf-esign-header",innerHTML:t.title},e);Object.assign(d.style,{position:"absolute"});let h=r("canvas",{width:n,height:c,className:"cieaf-esign-canvas"},e);Object.assign(h.style,{background:t.background});let i=h.getContext("2d");i.strokeStyle=t.color,i.lineWidth=t.lineWidth,i.lineCap="round";let f,L,m=0,v=0;function M(o){let a=o;for(m=v=0;a;){a.nodeType===11&&a.host&&(a=a.host);let l=a.offsetLeft,s=a.offsetTop;if(isNaN(s))return;m+=l,v+=s,a=a.parentNode}}h.addEventListener("touchstart",o=>{o.preventDefault();let a=o.targetTouches[0];f=a.pageX,L=a.pageY,M(o.target)}),h.addEventListener("touchmove",o=>{o.preventDefault();let a=o.targetTouches[0],{pageX:l,pageY:s}=a;i.beginPath(),i.moveTo(f-m,L-v),i.lineTo(l-m,s-v),i.stroke(),f=l,L=s}),h.addEventListener("touchend",o=>{o.preventDefault(),f=f=void 0}),h.addEventListener("touchcancel",o=>{o.preventDefault(),f=f=void 0});let p=r("footer",{className:"cieaf-esign-footer"},e);return Object.assign(p.style,{position:"absolute",bottom:0,right:0}),r("button",{innerHTML:"confirm",className:"cieaf-esign-confirm"},p).addEventListener("click",()=>{let o=i.getImageData(0,0,n,c).data,a=c,l=0,s=n,k=0;for(let g=0;g<n;g++)for(let u=0;u<c;u++){let j=(g+n*u)*4;o[j+3]>0&&(s=Math.min(g,s),k=Math.max(g,k),a=Math.min(u,a),l=Math.max(u,l))}if(l==0)return;let D=k-s,N=l-a,O=i.getImageData(s,a,D,N),x=r("canvas",{width:D,height:N});x.getContext("2d").putImageData(O,0,0),t.ok(x.toDataURL())}),r("button",{innerHTML:"clear",className:"cieaf-esign-clear"},p).addEventListener("click",()=>{i.clearRect(0,0,n,c)}),r("button",{innerHTML:"cancel",className:"cieaf-esign-cancel"},p).addEventListener("click",()=>{e.remove()}),e}return I(R);})();
